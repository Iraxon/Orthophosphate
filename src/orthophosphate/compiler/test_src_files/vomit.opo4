/* This is made from
vomit.mcfunction, found inside
example_mcfunction_files */

/* This includes features that have not
yet been implemented in Orthophosphate,
as needed to translate the original mcfunction */

function vomit {
    obj atk_cd;
    score @e[tag=infected] atk_cd += constant 0;

    exec asat @e[tag=LAWRN__selected]
    if score @s atk_cd matches 0
    anchored eyes
    pos ~ ~ ~
    if entity @n[,tag=target,distance=..12]

    run tag @s add LAWRN__attacking in {
        exec asat @e[tag=LAWRN__attacking]
        anchored eyes positioned ^ ^ ^1 {
            at @e[tag=LAWRN__target,distance=..16] run damage @e[sort=nearest,limit=1,tag=LAWRN__target,distance=..0.01] 0 mob_attack by @s;
            run mark summon_cloud;
            run playsound {
                minecraft:block.slime_block.place hostile @a ~ ~ ~ 1 0.5;
                minecraft:block.slime_block.hit hostile @a ~ ~ ~ 1 1;
                minecraft:entity.player.burp hostile @a ~ ~ ~ 1 0.5;
                minecraft:entity.villager.work_cleric hostile @a ~ ~ ~ 1 2;
                minecraft:block.lever.click hostile @a ~ ~ ~ 1 2;
            }
        }
    }

}
